<VirtualHost *:80>
    ServerName grafana.bergman.house

    Alias /.well-known/acme-challenge/ "/var/www/html/.well-known/acme-challenge/"
    <Directory "/var/www/html/">
        AllowOverride None
        Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
        Require method GET POST OPTIONS
    </Directory>

    RewriteCond %{REQUEST_URI} !^/.well-known/acme-challenge [NC]
    RewriteCond %{HTTPS} off
    RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}
</VirtualHost>

<VirtualHost *:443>
    SSLEngine on
    SSLProxyEngine on
    ServerName grafana.bergman.house
    SSLCertificateFile /storage/tls/letsencrypt/live/grafana.bergman.house/fullchain.pem
    SSLCertificateKeyFile /storage/tls/letsencrypt/live/grafana.bergman.house/privkey.pem

    ProxyPass "/" "http://10.6.0.7:3000/"
    ProxyPassReverse "/" "http://10.6.0.7:3000/"
</VirtualHost>
